# Keyboard Shortcuts

Relevant source files

- [](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/core/workspace-shell/index.ts)
- [](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/index.ts)
- [](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts)
- [](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/ui/SceneCommandHotkeys.tsx)
- [](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/workspace/model/index.ts)
- [](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/shared/shortcuts/index.ts)

This page documents the global keyboard shortcut system in puppet-studio: the `useSceneCommandHotkeys` hook, the `SceneCommandHotkeys` wrapper component, the guard conditions that gate each shortcut, and the `AppCommand` dispatched for each key. For the command types themselves, see [4.1](https://deepwiki.com/e7canasta/puppet-studio/4.1-appcommand-types-and-dispatch). For the terminal's own internal command input, see [6.5](https://deepwiki.com/e7canasta/puppet-studio/6.5-scene-event-terminal) and [6.6](https://deepwiki.com/e7canasta/puppet-studio/6.6-terminal-command-processing). For the command palette triggered by a separate hotkey, see [6.7](https://deepwiki.com/e7canasta/puppet-studio/6.7-workspace-command-palette).

---

## Component Mounting

`SceneCommandHotkeys` is a renderless React component. It calls `useSceneCommandHotkeys()` and returns `null`. It is mounted directly under `App.tsx` so the listener is global and persistent for the entire application lifetime.

**Diagram: Mounting structure**

Sources: [src/features/scene/ui/SceneCommandHotkeys.tsx1-6](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/ui/SceneCommandHotkeys.tsx#L1-L6) [src/features/scene/hooks/useSceneCommandHotkeys.ts9-143](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L9-L143)

---

## Guard Conditions

Before any hotkey action is taken, the `onKeyDown` handler evaluates a cascade of guards. If a guard fails, the handler returns early.

**Diagram: Guard evaluation flow**

Sources: [src/features/scene/hooks/useSceneCommandHotkeys.ts13-136](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L13-L136)

### `isEditableTarget`

Defined in `src/features/scene/model`, this function checks whether the event's `target` is an element that accepts text input (e.g., `<input>`, `<textarea>`, `contenteditable`). When true, all hotkeys are suppressed so the user can type freely.

Sources: [src/features/scene/hooks/useSceneCommandHotkeys.ts14](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L14-L14)

### `isPrimaryShortcut`

Imported from `src/shared/shortcuts`, this helper abstracts platform-specific modifier detection. It returns `true` when either `Ctrl` (Windows/Linux) or `Meta`/`Cmd` (macOS) is held along with the specified key, normalizing cross-platform behavior.

Sources: [src/shared/shortcuts/index.ts1-2](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/shared/shortcuts/index.ts#L1-L2) [src/features/scene/hooks/useSceneCommandHotkeys.ts5](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L5-L5)

---

## Hotkey Reference

### Always-active shortcuts

These fire regardless of `sceneEditEnabled` or `selectedPlacementId`, only blocked by `isEditableTarget`.

|Key(s)|Condition|AppCommand dispatched|
|---|---|---|
|`` ` `` (backtick)|—|`toggle_scene_event_terminal`|
|`Ctrl/Cmd + 9`|—|`toggle_scene_event_terminal`|
|`1`|no `altKey`, no `ctrlKey`/`metaKey`|`set_active_tool` `mode: 'select'`|
|`2`|no `altKey`, no `ctrlKey`/`metaKey`|`set_active_tool` `mode: 'move'`|
|`3`|no `altKey`, no `ctrlKey`/`metaKey`|`set_active_tool` `mode: 'rotate'`|
|`m`|no `altKey`, no `ctrlKey`/`metaKey`|`set_show_dimensions` (toggles `state.showDimensions`)|

Sources: [src/features/scene/hooks/useSceneCommandHotkeys.ts19-73](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L19-L73)

### Edit-mode shortcuts (require `sceneEditEnabled`)

|Key(s)|Additional condition|AppCommand dispatched|
|---|---|---|
|`Ctrl/Cmd + Z`|no `shiftKey`|`undo_scene_edit`|
|`Ctrl/Cmd + Y`|—|`redo_scene_edit`|
|`Ctrl/Cmd + Shift + Z`|—|`redo_scene_edit`|

Sources: [src/features/scene/hooks/useSceneCommandHotkeys.ts31-43](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L31-L43)

### Selection-required shortcuts (require `sceneEditEnabled` + `selectedPlacementId`)

These operate on the currently selected placement. Step sizes are affected by the `Shift` modifier (see [Shift Modifier](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/Shift%20Modifier) below).

|Key|Action|AppCommand dispatched|Delta|
|---|---|---|---|
|`W`|Move forward (+Y)|`run_scene_command` → `move_selected_by`|`[0, moveStep]`|
|`S`|Move backward (−Y)|`run_scene_command` → `move_selected_by`|`[0, -moveStep]`|
|`A`|Move left (−X)|`run_scene_command` → `move_selected_by`|`[-moveStep, 0]`|
|`D`|Move right (+X)|`run_scene_command` → `move_selected_by`|`[moveStep, 0]`|
|`Q`|Rotate counter-clockwise|`run_scene_command` → `rotate_selected_by`|`-rotateStep`|
|`E`|Rotate clockwise|`run_scene_command` → `rotate_selected_by`|`+rotateStep`|
|`G`|Snap to grid|`run_scene_command` → `snap_selected_to_grid`|`SCENE_COMMAND_SNAP_STEP_M`|

Sources: [src/features/scene/hooks/useSceneCommandHotkeys.ts81-135](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L81-L135)

---

## Shift Modifier

When `Shift` is held during movement or rotation commands, the step size is multiplied:

|Step constant|Base value|With `Shift`|
|---|---|---|
|`SCENE_COMMAND_MOVE_STEP_M`|from `core/config`|× 5|
|`SCENE_COMMAND_ROTATE_STEP_DEG`|from `core/config`|× 3|

The `G` (snap-to-grid) command always uses `SCENE_COMMAND_SNAP_STEP_M` regardless of `Shift`.

Sources: [src/features/scene/hooks/useSceneCommandHotkeys.ts4](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L4-L4) [src/features/scene/hooks/useSceneCommandHotkeys.ts78-79](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L78-L79)

---

## Key Processing Summary Diagram

This diagram maps each key symbol to the code entities involved in handling it.

Sources: [src/features/scene/hooks/useSceneCommandHotkeys.ts11-136](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L11-L136)

---

## `STUDIO_SHORTCUTS` Constants

The `src/shared/shortcuts` module exports `isPrimaryShortcut` (and any `STUDIO_SHORTCUTS` constants defined in `studioShortcuts.ts`). The hook imports `isPrimaryShortcut` directly to implement cross-platform `Ctrl`/`Cmd` detection for the `9`, `Z`, and `Y` bindings. The raw key string comparisons (`` ` ``, `1`–`3`, `m`, `w`, `a`, `s`, `d`, `q`, `e`, `g`) are performed inline against `event.key.toLowerCase()`.

Sources: [src/shared/shortcuts/index.ts1-2](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/shared/shortcuts/index.ts#L1-L2) [src/features/scene/hooks/useSceneCommandHotkeys.ts5](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L5-L5) [src/features/scene/hooks/useSceneCommandHotkeys.ts19-135](https://github.com/e7canasta/puppet-studio/blob/cdd483bd/src/features/scene/hooks/useSceneCommandHotkeys.ts#L19-L135)


### On this page

- [Keyboard Shortcuts](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#keyboard-shortcuts)
- [Component Mounting](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#component-mounting)
- [Guard Conditions](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#guard-conditions)
- [`isEditableTarget`](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#iseditabletarget)
- [`isPrimaryShortcut`](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#isprimaryshortcut)
- [Hotkey Reference](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#hotkey-reference)
- [Always-active shortcuts](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#always-active-shortcuts)
- [Edit-mode shortcuts (require `sceneEditEnabled`)](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#edit-mode-shortcuts-require-sceneeditenabled)
- [Selection-required shortcuts (require `sceneEditEnabled` + `selectedPlacementId`)](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#selection-required-shortcuts-require-sceneeditenabled-selectedplacementid)
- [Shift Modifier](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#shift-modifier)
- [Key Processing Summary Diagram](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#key-processing-summary-diagram)
- [`STUDIO_SHORTCUTS` Constants](https://deepwiki.com/e7canasta/puppet-studio/6.8-keyboard-shortcuts#studio_shortcuts-constants)

